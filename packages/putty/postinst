#!/data/data/com.termux/files/usr/bin/bash
IFS=$'\n\t'
v='0.77' # https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html
echo "Download PuTTY source code ..."
wget https://the.earth.li/~sgtatham/putty/latest/putty-$v.tar.gz -O ${TMPDIR}/putty-$v.tar.gz
tar -xzvf ${TMPDIR}/putty-$v.tar.gz -C ${HOME}/.local/share/
[[ -d ${HOME}/.local/share/putty-$v ]] && {
  echo "Building putty for $(uname -m) ..."
  mv ${HOME}/.local/share/putty-$v ${HOME}/.local/share/putty
  cd ${HOME}/.local/share/putty
  cmake .
  sed -i "s|G_APPLICATION_FLAGS_NONE|G_APPLICATION_DEFAULT_FLAGS|g" \
    ${HOME}/.local/share/putty/unix/main-gtk-application.c
  cmake --build .
  cmake --build . --target install
  chmod 751 -R ${HOME}/.local/share/putty
} || {
  echo -en "\e[31mE:\e[0m putty directory missing ... \e[33mAborting.\e[0m\n";
  exit 1;
}
wget --tries=20 --quiet https://raw.githubusercontent.com/ivam3/i-Haklab/master/.deb/home/.local/bin/fixer -O /data/data/com.termux/files/usr/bin/fixer
chmod 750 /data/data/com.termux/files/usr/bin/fixer
echo "[*] putty installation finished."
echo "[*] Run \'putty\' to execute it."
echo "[*] Run \'fixer\' to fix any posible issue."
echo "[!] For help going to https://t.me/Ivam3_Bot."
echo "[*] @Ivam3: thank you for use my package."
####::: REPORT ISSUES AT https://t.me/Ivam3_Bot :::####
